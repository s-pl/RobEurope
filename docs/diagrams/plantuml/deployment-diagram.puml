@startuml Deployment Diagram

title RobEurope Platform - Deployment Architecture

node "User's Browser" as Browser {
    component "React Frontend" as React <<Web Application>>
    component "Admin Panel (EJS)" as AdminPanel <<Web Application>>
}

node "Production Server" as ProdServer {
    component "Nginx Reverse Proxy" as Nginx <<Web Server>> {
        portin "443 (HTTPS)" as https
        portin "80 (HTTP)" as http
    }

    component "Node.js Application" as NodeApp <<Application Server>> {
        component "Express API" as API <<REST API>>
        component "Admin Routes" as AdminRoutes <<Web Routes>>
        component "Authentication" as Auth <<Security>>
        component "File Upload" as Upload <<Service>>
    }

    database "MySQL Database" as MySQL <<Database>> {
        component "User Tables" as UserDB
        component "Team Tables" as TeamDB
        component "Competition Tables" as CompDB
        component "Content Tables" as ContentDB
    }

    database "Redis Cache" as Redis <<Cache>> {
        component "Session Store" as Sessions
        component "Query Cache" as QueryCache
    }
}

node "External Services" as External {
    database "OpenLDAP Server" as LDAP <<Directory Service>> {
        component "User Directory" as UserDir
        component "Group Directory" as GroupDir
    }

    component "Bind9 DNS Server" as DNS <<DNS Service>> {
        component "DNS Records" as DNSRecords
    }

    component "SMTP Server" as SMTP <<Email Service>> {
        component "Email Queue" as EmailQueue
    }

    component "File Storage" as Storage <<Storage Service>> {
        component "Media Files" as MediaFiles
    }
}

' Development Environment
node "Development Environment" as DevEnv {
    component "Docker Compose" as DockerCompose <<Container Orchestrator>>

    component "Dev Database" as DevDB <<Database>>
    component "Dev LDAP" as DevLDAP <<Directory Service>>
    component "Dev DNS" as DevDNS <<DNS Service>>
}

' Connections
Browser --> Nginx : HTTPS/HTTP
Nginx --> API : Internal API calls
Nginx --> AdminRoutes : Admin panel requests
Nginx --> React : Static files (future)
Nginx --> AdminPanel : Admin interface

API --> MySQL : Database queries
API --> Redis : Session management
API --> Auth : Authentication
API --> Upload : File operations

Auth --> LDAP : User authentication
Auth --> MySQL : User validation

Upload --> Storage : File storage
Upload --> MySQL : File metadata

API --> SMTP : Email notifications

' Development connections
DockerCompose --> DevDB : Manages
DockerCompose --> DevLDAP : Manages
DockerCompose --> DevDNS : Manages
DockerCompose --> NodeApp : Runs application

' External service connections
LDAP --> DNS : DNS resolution
SMTP --> DNS : MX records

' Data flow notes
note right of Browser
    **Client Layer**
    - React SPA (planned)
    - EJS Admin Panel
    - Static assets
    - Real-time updates
end note

note right of Nginx
    **Load Balancer & Proxy**
    - SSL termination
    - Request routing
    - Static file serving
    - Rate limiting
end note

note right of NodeApp
    **Application Layer**
    - Express.js server
    - Business logic
    - API endpoints
    - Middleware stack
end note

note right of MySQL
    **Data Layer**
    - Persistent storage
    - ACID transactions
    - Data relationships
    - Audit logging
end note

note right of External
    **External Services**
    - LDAP: User directory
    - DNS: Name resolution
    - SMTP: Email delivery
    - Storage: File hosting
end note

' Security boundaries
note as SecurityZone
    **Security Zones:**
    - Public Zone (Browser)
    - DMZ (Nginx Proxy)
    - Application Zone (Node.js)
    - Data Zone (Databases)
    - External Zone (LDAP, DNS, SMTP)
end note

' Scaling notes
note as ScalingNote
    **Scalability:**
    - Horizontal scaling for API
    - Database read replicas
    - Redis clustering
    - CDN for static assets
    - Load balancer clustering
end note

@enduml